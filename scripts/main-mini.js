$(document).ready(function(){var e=localStorage,a=e.i||0,f=$("#list"),p=JSON.parse(e.getItem("d"))||[],l=JSON.parse(e.getItem("c"))||[],j=JSON.parse(e.getItem("s"))||[];"undefined"===typeof e.i&&e.setItem("i",0);"undefined"===typeof e.d&&e.setItem("d","[]");"undefined"===typeof e.c&&e.setItem("c","[]");"undefined"===typeof e.s&&(e.setItem("s","[]"),j={textColor:"#000000",bgColor:"#ffffaa"},e.s=JSON.stringify(j));"undefined"===typeof e.TS&&e.setItem("TS",5242880-unescape(encodeURIComponent(JSON.stringify(e))).length);e.length!==localStorage.length&&(e=localStorage);if(0<l.length){var i=0;for(f.html("");i<l.length;++i){f.html(f.html()+'<li id="'+l[i]+'">'+e.getItem(l[i])+"</li>\n")}if(0<p.length){for(i=0;i<=p.length;i++){$("#"+p[i])&&$("#"+p[i]).html("<del>"+$("#"+p[i]).html()+"</del>")}}f.html(f.html()+'<li><input type="text" placeholder="To-Do" autofocus></li>')}$("input").bind("keypress",function(b){b=b.keyCode||b.which;13==b&&(b=$(this).val(),0!==b.length&&($(this).parent().append(b),e.setItem(++a+"",b),e.setItem("i",a),l[l.length]=a,$("li").last().after("<li></li>"),b=$("li").last(),b.css("color",j.textColor),$(this).val("").appendTo(b).focus(),e.c=JSON.stringify(l)))});$("ul > li").click(function(c){if("edit"!=c.toElement.id&&"newEdit"!=c.toElement.id){c=$(this);var b=c.attr("id");c.find("del")[0]||(c.html("<del>"+c.html()+"</del>"),p[p.length]=b,e.d=JSON.stringify(p))}}).dblclick(function(c){if("edit"!=c.toElement.id&&"newEdit"!=c.toElement.id){c=$(this);var b=c.attr("id"),d=0;if(c.find("del")[0]){c.slideUp();for(e.getItem(b)&&e.removeItem(b);d<p.length;d++){p[d]==b&&p.splice(d)}for(d=0;d<l.length;d++){l[d]==b&&l.splice(d)}e.d=JSON.stringify(p);e.c=JSON.stringify(l)}}}).mouseover(function(){$(this).find("del")[0]||($("#edit").css("display","inline-block"),$("#edit").appendTo($(this)))}).mouseout(function(){$("#edit").css("display","none")});var o="";$("#edit").click(function(){var b=$(this).parent();o=b.html();$(this).appendTo(f);$(this).css("display","none");b.html('<input type="text" id="newEdit" autofocus="true">');b.off();$("#newEdit").focus().bind("keypress",function(c){c=c.keyCode||c.which;if(13==c){c=$(this).val();var d=$(this).parent();$(this).remove();if(0==c.length){return d.html(o)}d.html(c);e.setItem(d.attr("id"),c)}})});$("li").last().off();$("#settings").click(function(){this.classList.toggle("change");switch(Number($(this).data("open"))){case 0:$("aside").css("display","block");$("#wrap").css("position","absolute").css("left","350px");break;case 1:$("aside").css("display","none"),$("#wrap").css("position","static").css("left","0px")}$(this).data("open",0==Number($(this).data("open"))?1:0)});"color"==$("#tColor").attr("type")?($("#tColor").val(j.textColor).change(function(){$("h1,h2,h3,li,p,input[type=text],label,span").css("color",$(this).val());j.textColor=$(this).val();e.s=JSON.stringify(j)}),$("#bgColor").val(j.bgColor).change(function(){$("body,input[type=text]").css("background-color",$(this).val());j.bgColor=$(this).val();e.s=JSON.stringify(j)})):($("#tColor").parent().html('Text Color: <div class="preview"></div>'),$("#bgColor").parent().html('Background Color: <div class="preview"></div>'),$("aside").html($(this).html()+'<div class="colorpicker" style="display:none"><canvas id="picker" var="1" width="300" height="300"></canvas><div class="controls"><div><label>R</label> <input type="text" id="rVal" /></div><div><label>G</label> <input type="text" id="gVal" /></div><div><label>B</label> <input type="text" id="bVal" /></div><div><label>RGB</label> <input type="text" id="rgbVal" /></div><div><label>HEX</label> <input type="text" id="hexVal" /></div></div></div>'),$(function(){var h=!0,g=document.getElementById("picker"),k=g.getContext("2d"),n=new Image;n.onload=function(){k.drawImage(n,0,0,n.width,n.height)};var m="images/colorwheel1.png";switch($(g).attr("var")){case"2":m="images/colorwheel2.png";break;case"3":m="images/colorwheel3.png";break;case"4":m="images/colorwheel4.png";break;case"5":m="images/colorwheel5.png"}n.src=m;$("#picker").mousemove(function(b){if(h){var d=$(g).offset();b=k.getImageData(Math.floor(b.pageX-d.left),Math.floor(b.pageY-d.top),1,1).data;d="rgb("+b[0]+", "+b[1]+", "+b[2]+")";$(".preview").css("backgroundColor",d);$("#rVal").val(b[0]);$("#gVal").val(b[1]);$("#bVal").val(b[2]);$("#rgbVal").val(b[0]+","+b[1]+","+b[2]);b=b[2]+256*b[1]+65536*b[0];$("#hexVal").val("#"+("0000"+b.toString(16)).substr(-6))}});$("#picker").click(function(c){h=!h});$(".preview").click(function(c){$(".colorpicker").fadeToggle("slow","linear");h=!0})}),$(".colorpicker").css("background-color","#222222").css("border-radius","5px 5px 5px 5px").css("box-shadow","2px 2px 2px #444444").css("color","#FFFFFF").css("font-size","12px").css("position","absolute").css("width","460px"),$("#picker").css("cursor","crosshair").css("float","left").css("margin","10px").css("border","0"),$(".controls").css("float","right").css("margin","10px"),$(".controls > div").css("border","1px solid #2F2F2F").css("margin-bottom","5px").css("overflow","hidden").css("padding","5px"),$(".controls label").css("float","left"),$(".controls > div input").css("background-color","#121212").css("border","1px solid #2F2F2F").css("color","#DDDDDD").css("float","right").css("font-size","10px").css("height","14px").css("margin-left","6px").css("text-align","center").css("text-transform","uppercase").css("width","75px"),$(".preview").css("background",'url("../images/select.png") repeat scroll center center transparent').css("border-radius","3px").css("box-shadow","2px 2px 2px #444444").css("cursor","pointer").css("height","30px").css("width","30px"));$("h1,h2,h3,li,p,input[type=text],label,span").css("color",j.textColor);$("body,input[type=text]").css("background-color",j.bgColor)});